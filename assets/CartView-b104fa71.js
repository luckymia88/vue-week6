import{_ as m,o as c,c as i,a as p,d as t,F as u,f as g,g as f,t as o,h as $,v as C}from"./index-dfc896fb.js";const{VITE_APP_URL:n,VITE_APP_PATH:r}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"luckymia",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0},x={data(){return{products:[],productId:"",cart:{},loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts(){this.$http.get(`${n}api/${r}/cart`).then(e=>{this.cart=e.data.data}).catch(e=>{alert(e.data.message)})},updateCarts(e){const s={product_id:e.product.id,qty:e.qty};this.loadingItem=e.id,this.$http.put(`${n}api/${r}/cart/${e.id}`,{data:s}).then(h=>{this.getCarts(),this.loadingItem=""}).catch(h=>{alert(h.data.message)})},deleteItem(e){this.loadingItem=e.id,this.$http.delete(`${n}api/${r}/cart/${e.id}`).then(s=>{this.getCarts(),this.loadingItem=""}).catch(s=>{alert(s.data.message)})},deleteCarts(e){this.$http.delete(`${n}api/${r}/carts`).then(s=>{this.getCarts()}).catch(s=>{alert(s.data.message)})},createOrder(){const e=this.form;this.$http.post(`${n}api/${r}/order`,{data:e}).then(s=>{alert(s.data.message),this.$refs.form.resetForm(),this.getCarts()}).catch(s=>{alert(s.message)})}},mounted(){this.getCarts()}},I={class:"table align-middle"},b=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),y=["onClick","disabled"],P=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),V={class:"input-group input-group-sm"},v=["onUpdate:modelValue","disabled","onChange"],k=["value"],E={class:"text-end"},A=t("td",{colspan:"3",class:"text-end"},"總計",-1),T={class:"text-end"},D=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),U={class:"text-end text-success"};function q(e,s,h,B,l,_){return c(),i(u,null,[p(" 這是購物車頁面 "),t("table",I,[b,t("tbody",null,[l.cart.carts?(c(!0),i(u,{key:0},g(l.cart.carts,a=>(c(),i("tr",{key:a.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:d=>_.deleteItem(a),disabled:a.id===l.loadingItem},[P,p(" x ")],8,y)]),t("td",null,o(a.product.title),1),t("td",null,[t("div",V,[$(t("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":d=>a.qty=d,disabled:a.id===l.loadingItem,onChange:d=>_.updateCarts(a)},[(c(),i(u,null,g(20,d=>t("option",{value:d,key:`${d}12345`},o(d),9,k)),64))],40,v),[[C,a.qty]])])]),t("td",E,o(a.total),1)]))),128)):f("",!0)]),t("tfoot",null,[t("tr",null,[A,t("td",T,o(l.cart.total),1)]),t("tr",null,[D,t("td",U,o(l.cart.final_total),1)])])])],64)}const R=m(x,[["render",q]]);export{R as default};
